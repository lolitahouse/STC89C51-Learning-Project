C51 COMPILER V9.01   MAIN                                                                  09/30/2022 07:45:39 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\Obj\main.obj
COMPILER INVOKED BY: D:\programming learning software\MCU\keilC51\C51\BIN\C51.EXE main.c BROWSE INCDIR(..\Public) DEBUG 
                    -OBJECTEXTEND PRINT(..\Listing\main.lst) OBJECT(..\Obj\main.obj)

line level    source

   1          /**************************************************************************************
   2          实验名称：      串口通信实验
   3          实验现象：      串口助手发送数据给单片机，单片机原封不动转发给串口助手显示
   4          实验单片机：普中A2                      
   5          注意事项：      使用黄色跳线帽将CH340旁的P5端子的UTX和P30短接，URX和P31短接，出厂默认已短接好                                                                                                                                    
             - 
   6          ***************************************************************************************/
   7          
   8          #include "public.h"
   9          
  10          /*
  11                  函数名： uart_Init
  12                  功能：   串口通信中断配置函数，通过设置TH和TL即可确定定时时间
  13          */
  14          void uart_Init(uint_8 baud)
  15          {
  16   1              TMOD |= 0X20;           //设置计数器工作方式2
  17   1              SCON = 0X50;            //设置为工作方式1
  18   1              PCON = 0X80;            //波特率加倍
  19   1              TH1 = baud;                     //计数器初始值设置
  20   1              TL1 = baud;
  21   1              ES = 1;                         //打开接收中断
  22   1              EA = 1;                         //打开总中断
  23   1              TR1 = 1;                        //打开计数器            
  24   1      }
  25          
  26          
  27          
  28          int main(void)
  29          {
  30   1              uart_Init(0XFA);        //波特率为9600
  31   1                                              
  32   1              while(1)
  33   1              {
  34   2                      
  35   2              }
  36   1      }
  37          
  38          
  39          /*
  40                  ////串口通信中断函数    
  41          */
  42          void uart() interrupt 4 
  43          {
  44   1              uint_8 rec_data;
  45   1      
  46   1              RI = 0;                         //清除接收中断标志位
  47   1              rec_data = SBUF;        //存储接收到的数据
  48   1              SBUF = rec_data;        //将接收到的数据放入到发送寄存器
  49   1              while(!TI);                     //等待发送数据完成
  50   1              TI = 0;                         //清除发送完成标志位                                            
  51   1      }
  52          
  53          
C51 COMPILER V9.01   MAIN                                                                  09/30/2022 07:45:39 PAGE 2   

  54          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     50    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
