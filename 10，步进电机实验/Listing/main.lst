C51 COMPILER V9.01   MAIN                                                                  09/30/2022 00:28:16 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\Obj\main.obj
COMPILER INVOKED BY: D:\programming learning software\MCU\keilC51\C51\BIN\C51.EXE main.c BROWSE INCDIR(..\App\bsp_step_m
                    -otor;..\Public;..\App\bsp_key) DEBUG OBJECTEXTEND PRINT(..\Listing\main.lst) OBJECT(..\Obj\main.obj)

line level    source

   1          /**************************************************************************************
   2          实验名称：      步进电机实验
   3          实验现象：      按下KEY1键可调节电机旋转方向；按下KEY2键，电机加速；按下KEY3键，电机减速;
   4          实验单片机：普中A2                      
   5          注意事项：      将步进电机红色线对接到“步进电机模块”输出端子J47的5V上，其它相序依次接入                                                                                                                                         
   6          ***************************************************************************************/
   7          
   8          #include "public.h"
   9          #include  "step_motor.h"
  10          #include  "key.h"
  11          
  12          int main(void)
  13          {
  14   1              uint_8 key_value = 0;
  15   1              uint_8 dir = 0;   //默认逆时针方向
  16   1              uint_8 speed = STEPMOTOR_MAXSPEED;      //默认最大速度旋转
  17   1              uint_8 step = 0;
  18   1                                              
  19   1              while(1)
  20   1              {
  21   2                      key_value = Key_Scan(0);                        //单次扫描
  22   2                      if(key_value == KEY1_PRESS)                     //key1 换向
  23   2                      {
  24   3                              dir = !dir;    
  25   3                      }
  26   2                      else if(key_value == KEY2_PRESS)        //key2 加速
  27   2                      {
  28   3                              if(speed > STEPMOTOR_MAXSPEED)
  29   3                                      speed -= 1;                     
  30   3                      }
  31   2                      else if(key_value == KEY3_PRESS)        //key3 减速
  32   2                      {
  33   3                              if(speed < STEPMOTOR_MINSPEED)
  34   3                                      speed += 1;                     
  35   3                      }       
  36   2      
  37   2                      Step_Motor_Send_Pulse(step++,dir);
  38   2                      if(step == 8)           step = 0;               
  39   2                      Delay_ms(speed);
  40   2              }
  41   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     92    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
